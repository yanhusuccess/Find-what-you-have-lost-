# å¤±ç‰©æ‹›é¢†ç³»ç»Ÿ - éƒ¨ç½²æŒ‡å—

## ğŸ“‹ ç›®å½•
1. [ç¯å¢ƒå‡†å¤‡](#ç¯å¢ƒå‡†å¤‡)
2. [æœ¬åœ°å¼€å‘éƒ¨ç½²](#æœ¬åœ°å¼€å‘éƒ¨ç½²)
3. [ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²](#ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²)
4. [Dockeréƒ¨ç½²](#dockeréƒ¨ç½²)
5. [äº‘æœåŠ¡å™¨éƒ¨ç½²](#äº‘æœåŠ¡å™¨éƒ¨ç½²)
6. [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
7. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ğŸ”§ ç¯å¢ƒå‡†å¤‡

### ç³»ç»Ÿè¦æ±‚
- **æ“ä½œç³»ç»Ÿ**ï¼šWindows 10+, Linux, macOS
- **Pythonç‰ˆæœ¬**ï¼š3.7+
- **å†…å­˜**ï¼šæœ€ä½512MBï¼Œæ¨è2GB+
- **ç£ç›˜ç©ºé—´**ï¼šæœ€ä½500MB
- **æµè§ˆå™¨**ï¼šChrome, Firefox, Edge, Safariæœ€æ–°ç‰ˆ

### å¿…éœ€è½¯ä»¶
```bash
# Python 3.7+
python --version

# pipåŒ…ç®¡ç†å™¨
pip --version

# Gitï¼ˆå¯é€‰ï¼‰
git --version
```

---

## ğŸ’» æœ¬åœ°å¼€å‘éƒ¨ç½²

### 1. å¿«é€Ÿå¯åŠ¨

#### Windowsç”¨æˆ·
```bash
# åŒå‡»è¿è¡Œ
run.bat
```

#### Linux/Macç”¨æˆ·
```bash
# æ·»åŠ æ‰§è¡Œæƒé™
chmod +x run.sh

# è¿è¡Œè„šæœ¬
./run.sh
```

### 2. æ‰‹åŠ¨éƒ¨ç½²æ­¥éª¤

#### æ­¥éª¤1ï¼šå…‹éš†/ä¸‹è½½é¡¹ç›®
```bash
# ä½¿ç”¨Gitå…‹éš†
git clone <repository-url>
cd project_lost

# æˆ–ç›´æ¥ä¸‹è½½ZIPè§£å‹
```

#### æ­¥éª¤2ï¼šåˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python3 -m venv venv
source venv/bin/activate
```

#### æ­¥éª¤3ï¼šå®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

#### æ­¥éª¤4ï¼šåˆå§‹åŒ–æ•°æ®åº“
```bash
# è¿è¡Œåº”ç”¨ä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®åº“
python app.py
```

#### æ­¥éª¤5ï¼šè®¿é—®åº”ç”¨
```
æµè§ˆå™¨æ‰“å¼€ï¼šhttp://localhost:5000
ç®¡ç†åå°ï¼šhttp://localhost:5000/admin
é»˜è®¤ç®¡ç†å‘˜ï¼šadmin / admin123
```

### 3. å¼€å‘æ¨¡å¼é…ç½®

åœ¨`app.py`ä¸­ä¿®æ”¹ï¼š
```python
# å¼€å‘æ¨¡å¼
app.run(debug=True, host='127.0.0.1', port=5000)

# debug=True: å¯ç”¨è°ƒè¯•æ¨¡å¼ï¼Œä»£ç ä¿®æ”¹è‡ªåŠ¨é‡è½½
# host='127.0.0.1': ä»…æœ¬æœºè®¿é—®
# port=5000: ç«¯å£å·
```

---

## ğŸš€ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### 1. å®‰å…¨é…ç½®

#### ä¿®æ”¹å¯†é’¥
```python
# app.py
app.config['SECRET_KEY'] = 'your-very-secure-secret-key-here'
# ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆå®‰å…¨å¯†é’¥
# python -c "import secrets; print(secrets.token_hex(32))"
```

#### ä¿®æ”¹ç®¡ç†å‘˜å¯†ç 
```python
# é¦–æ¬¡è¿è¡Œåï¼Œç™»å½•ç®¡ç†åå°ä¿®æ”¹å¯†ç 
# æˆ–åœ¨æ•°æ®åº“ä¸­ç›´æ¥ä¿®æ”¹
```

#### å…³é—­è°ƒè¯•æ¨¡å¼
```python
app.run(debug=False, host='0.0.0.0', port=5000)
```

### 2. ä½¿ç”¨WSGIæœåŠ¡å™¨

#### æ–¹æ¡ˆ1ï¼šGunicornï¼ˆæ¨èï¼‰
```bash
# å®‰è£…Gunicorn
pip install gunicorn

# è¿è¡Œ
gunicorn -w 4 -b 0.0.0.0:5000 app:app

# å‚æ•°è¯´æ˜ï¼š
# -w 4: 4ä¸ªworkerè¿›ç¨‹
# -b 0.0.0.0:5000: ç»‘å®šåœ°å€å’Œç«¯å£
# app:app: æ¨¡å—å:åº”ç”¨å
```

#### æ–¹æ¡ˆ2ï¼šuWSGI
```bash
# å®‰è£…uWSGI
pip install uwsgi

# è¿è¡Œ
uwsgi --http :5000 --wsgi-file app.py --callable app --processes 4 --threads 2
```

### 3. é…ç½®Nginxåå‘ä»£ç†

#### å®‰è£…Nginx
```bash
# Ubuntu/Debian
sudo apt install nginx

# CentOS/RHEL
sudo yum install nginx
```

#### Nginxé…ç½®æ–‡ä»¶
åˆ›å»º`/etc/nginx/sites-available/lostfound`ï¼š
```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location /static {
        alias /path/to/project_lost/static;
        expires 30d;
    }

    location /uploads {
        alias /path/to/project_lost/static/uploads;
        expires 30d;
    }
}
```

#### å¯ç”¨é…ç½®
```bash
# åˆ›å»ºè½¯é“¾æ¥
sudo ln -s /etc/nginx/sites-available/lostfound /etc/nginx/sites-enabled/

# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡å¯Nginx
sudo systemctl restart nginx
```

### 4. é…ç½®HTTPSï¼ˆLet's Encryptï¼‰

```bash
# å®‰è£…Certbot
sudo apt install certbot python3-certbot-nginx

# è·å–è¯ä¹¦
sudo certbot --nginx -d your-domain.com

# è‡ªåŠ¨ç»­æœŸ
sudo certbot renew --dry-run
```

### 5. ä½¿ç”¨Supervisorè¿›ç¨‹ç®¡ç†

#### å®‰è£…Supervisor
```bash
sudo apt install supervisor
```

#### é…ç½®æ–‡ä»¶
åˆ›å»º`/etc/supervisor/conf.d/lostfound.conf`ï¼š
```ini
[program:lostfound]
command=/path/to/venv/bin/gunicorn -w 4 -b 127.0.0.1:5000 app:app
directory=/path/to/project_lost
user=www-data
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/lostfound.log
```

#### å¯åŠ¨æœåŠ¡
```bash
# é‡æ–°åŠ è½½é…ç½®
sudo supervisorctl reread
sudo supervisorctl update

# å¯åŠ¨æœåŠ¡
sudo supervisorctl start lostfound

# æŸ¥çœ‹çŠ¶æ€
sudo supervisorctl status lostfound
```

---

## ğŸ³ Dockeréƒ¨ç½²

### 1. åˆ›å»ºDockerfile

```dockerfile
FROM python:3.9-slim

WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    gcc \
    && rm -rf /var/lib/apt/lists/*

# å¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY requirements.txt .

# å®‰è£…Pythonä¾èµ–
RUN pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶é¡¹ç›®æ–‡ä»¶
COPY . .

# åˆ›å»ºä¸Šä¼ ç›®å½•
RUN mkdir -p static/uploads

# æš´éœ²ç«¯å£
EXPOSE 5000

# è¿è¡Œåº”ç”¨
CMD ["gunicorn", "-w", "4", "-b", "0.0.0.0:5000", "app:app"]
```

### 2. åˆ›å»ºdocker-compose.yml

```yaml
version: '3.8'

services:
  web:
    build: .
    ports:
      - "5000:5000"
    volumes:
      - ./static/uploads:/app/static/uploads
      - ./lostfound.db:/app/lostfound.db
    environment:
      - FLASK_ENV=production
    restart: always

  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
      - ./static:/usr/share/nginx/html/static:ro
    depends_on:
      - web
    restart: always
```

### 3. æ„å»ºå’Œè¿è¡Œ

```bash
# æ„å»ºé•œåƒ
docker-compose build

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢æœåŠ¡
docker-compose down
```

---

## â˜ï¸ äº‘æœåŠ¡å™¨éƒ¨ç½²

### é˜¿é‡Œäº‘ECSéƒ¨ç½²

#### 1. è´­ä¹°æœåŠ¡å™¨
- æ“ä½œç³»ç»Ÿï¼šUbuntu 20.04 LTS
- é…ç½®ï¼š2æ ¸4GBï¼ˆæ¨èï¼‰
- å¸¦å®½ï¼š3Mbps+

#### 2. å®‰å…¨ç»„é…ç½®
å¼€æ”¾ç«¯å£ï¼š
- 22ï¼ˆSSHï¼‰
- 80ï¼ˆHTTPï¼‰
- 443ï¼ˆHTTPSï¼‰
- 5000ï¼ˆå¯é€‰ï¼Œç”¨äºè°ƒè¯•ï¼‰

#### 3. è¿æ¥æœåŠ¡å™¨
```bash
ssh root@your-server-ip
```

#### 4. å®‰è£…ç¯å¢ƒ
```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# å®‰è£…Pythonå’Œä¾èµ–
sudo apt install python3 python3-pip python3-venv nginx -y

# å®‰è£…Git
sudo apt install git -y
```

#### 5. éƒ¨ç½²åº”ç”¨
```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url> /var/www/lostfound
cd /var/www/lostfound

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
pip install gunicorn

# åˆå§‹åŒ–æ•°æ®åº“
python app.py
# Ctrl+C åœæ­¢

# ä½¿ç”¨Supervisorç®¡ç†ï¼ˆå‚è€ƒå‰é¢çš„é…ç½®ï¼‰
```

### è…¾è®¯äº‘éƒ¨ç½²
æµç¨‹ç±»ä¼¼é˜¿é‡Œäº‘ï¼Œæ³¨æ„å®‰å…¨ç»„é…ç½®ã€‚

### AWSéƒ¨ç½²
1. å¯åŠ¨EC2å®ä¾‹
2. é…ç½®å®‰å…¨ç»„
3. ä½¿ç”¨Elastic Beanstalkè‡ªåŠ¨éƒ¨ç½²

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

### 1. æ•°æ®åº“ä¼˜åŒ–

#### å‡çº§åˆ°PostgreSQL
```bash
# å®‰è£…PostgreSQL
sudo apt install postgresql postgresql-contrib

# åˆ›å»ºæ•°æ®åº“
sudo -u postgres createdb lostfound
sudo -u postgres createuser lostfound_user

# ä¿®æ”¹app.py
app.config['SQLALCHEMY_DATABASE_URI'] = 'postgresql://lostfound_user:password@localhost/lostfound'
```

#### æ·»åŠ ç´¢å¼•
```python
# åœ¨æ¨¡å‹ä¸­æ·»åŠ ç´¢å¼•
class LostItem(db.Model):
    # ...
    __table_args__ = (
        db.Index('idx_category', 'category'),
        db.Index('idx_status', 'status'),
        db.Index('idx_created_at', 'created_at'),
    )
```

### 2. ç¼“å­˜ä¼˜åŒ–

#### ä½¿ç”¨Redis
```bash
# å®‰è£…Redis
sudo apt install redis-server

# å®‰è£…PythonåŒ…
pip install redis flask-caching
```

```python
# app.py
from flask_caching import Cache

cache = Cache(app, config={
    'CACHE_TYPE': 'redis',
    'CACHE_REDIS_URL': 'redis://localhost:6379/0'
})

@app.route('/lost')
@cache.cached(timeout=300)
def lost_list():
    # ...
```

### 3. é™æ€èµ„æºä¼˜åŒ–

#### CDNåŠ é€Ÿ
```html
<!-- ä½¿ç”¨CDN -->
<link href="https://cdn.bootcdn.net/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
```

#### å›¾ç‰‡å‹ç¼©
```python
from PIL import Image

def compress_image(image_path):
    img = Image.open(image_path)
    img.save(image_path, optimize=True, quality=85)
```

#### Gzipå‹ç¼©
```python
from flask_compress import Compress
Compress(app)
```

### 4. è´Ÿè½½å‡è¡¡

ä½¿ç”¨Nginxé…ç½®å¤šä¸ªGunicornå®ä¾‹ï¼š
```nginx
upstream lostfound {
    server 127.0.0.1:5000;
    server 127.0.0.1:5001;
    server 127.0.0.1:5002;
    server 127.0.0.1:5003;
}

server {
    location / {
        proxy_pass http://lostfound;
    }
}
```

---

## ğŸ”’ å®‰å…¨åŠ å›º

### 1. é˜²ç«å¢™é…ç½®
```bash
# UFWé˜²ç«å¢™
sudo ufw allow 22
sudo ufw allow 80
sudo ufw allow 443
sudo ufw enable
```

### 2. é™åˆ¶ä¸Šä¼ æ–‡ä»¶
```python
# æ–‡ä»¶ç±»å‹ç™½åå•
ALLOWED_EXTENSIONS = {'png', 'jpg', 'jpeg', 'gif'}

def allowed_file(filename):
    return '.' in filename and \
           filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS
```

### 3. SQLæ³¨å…¥é˜²æŠ¤
ä½¿ç”¨ORMæŸ¥è¯¢ï¼Œé¿å…åŸç”ŸSQLï¼š
```python
# å®‰å…¨çš„æŸ¥è¯¢
items = LostItem.query.filter_by(category=category).all()

# ä¸å®‰å…¨çš„æŸ¥è¯¢ï¼ˆé¿å…ï¼‰
# items = db.session.execute(f"SELECT * FROM lost_item WHERE category='{category}'")
```

### 4. XSSé˜²æŠ¤
```python
from markupsafe import escape

# è½¬ä¹‰ç”¨æˆ·è¾“å…¥
safe_content = escape(user_input)
```

---

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### 1. æ—¥å¿—é…ç½®
```python
import logging
from logging.handlers import RotatingFileHandler

if not app.debug:
    handler = RotatingFileHandler('lostfound.log', maxBytes=10000000, backupCount=5)
    handler.setLevel(logging.INFO)
    app.logger.addHandler(handler)
```

### 2. æ€§èƒ½ç›‘æ§
```bash
# å®‰è£…ç›‘æ§å·¥å…·
pip install flask-profiler

# ä½¿ç”¨
from flask_profiler import Profiler
profiler = Profiler(app)
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: ç«¯å£è¢«å ç”¨
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
# Windows
netstat -ano | findstr :5000

# Linux
lsof -i :5000

# æ›´æ”¹ç«¯å£
app.run(port=5001)
```

### Q2: æ•°æ®åº“é”å®šé”™è¯¯
```python
# SQLiteå¹¶å‘é™åˆ¶ï¼Œå‡çº§åˆ°PostgreSQL
# æˆ–å¢åŠ è¶…æ—¶æ—¶é—´
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///lostfound.db?timeout=30'
```

### Q3: ä¸Šä¼ æ–‡ä»¶å¤±è´¥
```bash
# æ£€æŸ¥æ–‡ä»¶å¤¹æƒé™
chmod 755 static/uploads

# æ£€æŸ¥æ–‡ä»¶å¤§å°é™åˆ¶
app.config['MAX_CONTENT_LENGTH'] = 16 * 1024 * 1024  # 16MB
```

### Q4: é™æ€æ–‡ä»¶404
```bash
# æ£€æŸ¥é™æ€æ–‡ä»¶è·¯å¾„
ls -la static/

# æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
Ctrl + Shift + Delete
```

### Q5: æ•°æ®åº“è¿ç§»
```bash
# å®‰è£…Flask-Migrate
pip install Flask-Migrate

# åˆå§‹åŒ–
flask db init

# åˆ›å»ºè¿ç§»
flask db migrate -m "message"

# åº”ç”¨è¿ç§»
flask db upgrade
```

---

## ğŸ”„ å¤‡ä»½å’Œæ¢å¤

### å¤‡ä»½è„šæœ¬
```bash
#!/bin/bash
# backup.sh

DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/backups/lostfound"

# å¤‡ä»½æ•°æ®åº“
cp lostfound.db $BACKUP_DIR/lostfound_$DATE.db

# å¤‡ä»½ä¸Šä¼ æ–‡ä»¶
tar -czf $BACKUP_DIR/uploads_$DATE.tar.gz static/uploads

# åˆ é™¤30å¤©å‰çš„å¤‡ä»½
find $BACKUP_DIR -type f -mtime +30 -delete
```

### å®šæ—¶å¤‡ä»½
```bash
# æ·»åŠ åˆ°crontab
crontab -e

# æ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½
0 2 * * * /path/to/backup.sh
```

---

## ğŸ“ˆ æ€§èƒ½åŸºå‡†æµ‹è¯•

### å‹åŠ›æµ‹è¯•
```bash
# å®‰è£…abå·¥å…·
sudo apt install apache2-utils

# æµ‹è¯•
ab -n 1000 -c 100 http://localhost:5000/
```

### ä¼˜åŒ–å»ºè®®
- **<100ç”¨æˆ·**ï¼šSQLite + Flaskå†…ç½®æœåŠ¡å™¨
- **100-1000ç”¨æˆ·**ï¼šPostgreSQL + Gunicorn
- **1000-10000ç”¨æˆ·**ï¼šPostgreSQL + Gunicorn + Nginx + Redis
- **10000+ç”¨æˆ·**ï¼šé›†ç¾¤éƒ¨ç½² + è´Ÿè½½å‡è¡¡ + CDN

---

## ğŸ¯ éƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] Pythonç‰ˆæœ¬æ­£ç¡®ï¼ˆ3.7+ï¼‰
- [ ] æ‰€æœ‰ä¾èµ–å·²å®‰è£…
- [ ] SECRET_KEYå·²ä¿®æ”¹
- [ ] ç®¡ç†å‘˜å¯†ç å·²ä¿®æ”¹
- [ ] è°ƒè¯•æ¨¡å¼å·²å…³é—­
- [ ] æ•°æ®åº“å·²åˆå§‹åŒ–
- [ ] ä¸Šä¼ ç›®å½•æƒé™æ­£ç¡®
- [ ] Nginxé…ç½®æ­£ç¡®
- [ ] HTTPSè¯ä¹¦å·²é…ç½®
- [ ] é˜²ç«å¢™è§„åˆ™å·²è®¾ç½®
- [ ] æ—¥å¿—ç³»ç»Ÿå·²å¯ç”¨
- [ ] å¤‡ä»½è®¡åˆ’å·²è®¾ç½®
- [ ] ç›‘æ§ç³»ç»Ÿå·²éƒ¨ç½²

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°éƒ¨ç½²é—®é¢˜ï¼š
1. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
2. æ£€æŸ¥é˜²ç«å¢™å’Œç«¯å£
3. éªŒè¯æ–‡ä»¶æƒé™
4. æŸ¥é˜…æ–‡æ¡£
5. è”ç³»æŠ€æœ¯æ”¯æŒ

**ç¥æ‚¨éƒ¨ç½²é¡ºåˆ©ï¼** ğŸš€

